## Penalized-Linear Regression

## Ridge Regression 
## creates linear regression model that is penalized with the L2-norm 
## which is the sum of the squared coefficients. 
## shrinking the coefficient values (and the complexity of the model) 
## allowing some coefficients with minor contribution to the response to get close to zero.
# load the package
library(glmnet)
# load data
data(longley)
x <- as.matrix(longley[,1:6])
y <- as.matrix(longley[,7])
# fit model
fit <- glmnet(x, y, family="gaussian", alpha=0, lambda=0.001)
# summarize the fit
summary(fit)
# make predictions
predictions <- predict(fit, x, type="link")
# summarize accuracy
rmse <- mean((y - predictions)^2)
print(rmse)

## Least Absolute Shrinkage and Selection Operator (LASSO)
## creates a regression model that is penalized with the L1-norm 
## which is the sum of the absolute coefficients. 
## shrinking coefficient values (and the complexity of the model), 
## allowing some with a minor affect to the response to become zero.
# load the package
library(lars)
# load data
data(longley)
x <- as.matrix(longley[,1:6])
y <- as.matrix(longley[,7])
# fit model
fit <- lars(x, y, type="lasso")
# summarize the fit
summary(fit)
# select a step with a minimum error
best_step <- fit$df[which.min(fit$RSS)]
# make predictions
predictions <- predict(fit, x, s=best_step, type="fit")$fit
# summarize accuracy
rmse <- mean((y - predictions)^2)
print(rmse)


## Elastic Net
## creates a regression model that is penalized with both the L1-norm and L2-norm. 
## effect of effectively shrinking coefficients (as in ridge regression) 
## and setting some coefficients to zero (as in LASSO).
# load the package
library(glmnet)
# load data
data(longley)
x <- as.matrix(longley[,1:6])
y <- as.matrix(longley[,7])
# fit model
fit <- glmnet(x, y, family="gaussian", alpha=0.5, lambda=0.001)
# summarize the fit
summary(fit)
# make predictions
predictions <- predict(fit, x, type="link")
# summarize accuracy
rmse <- mean((y - predictions)^2)
print(rmse)


